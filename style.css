/* styles.optimized.css
Versión optimizada: duplicados eliminados, reglas reorganizadas,
rendimiento mejorado, preferencias dark/light con prefers-color-scheme
y .dark-mode (para toggle JS), accesibilidad preservada.
*/

/* ==========================

1. VARIABLES GLOBALES (ordenadas)
   ========================== */
   :root{
   --primary-font: 'Courgette', cursive;

/* Paleta base (tema claro por defecto) */
--bg-image: url('assets/images/fondo-romantico.jpg');
--background-attachment: scroll; /* evita problemas en móviles */

--text-light: #CDD8D5;
--text-medium: #AEA5A5;
--text-dark: #E0CFC1;
--header-color: #BCBDB9;

--background-overlay: rgba(32,30,43,0.7);
--container-bg: rgba(32,30,43,0.40);
--content-bg: #1E2021;

--border-color-input: #8E7383;
--input-bg: #6B5D74;

/* Acciones / estados */
--button-bg-initial: #9A8C8B;
--button-bg-hover: #3F3938;
--highlight-pink: #ff7aa8;
--highlight-pink-light: #ffaed0;
--highlight-green: #A3C3BD;
--progress-color: var(--highlight-green);
--highlight-red: #E74C3C;

/* Links */
--link-color: #FFC0CB;
--link-hover: #FFDDEE;

/* Toasts / modals / favoritos */
--achievement-bg: #4A4A6A;
--achievement-text: #E0CFC1;
--modal-bg: rgba(0,0,0,0.8);
--favorite-icon-default: #ccc;
--favorite-icon-active: #FFD700;
}

/* Preferencia automática: modo oscuro del sistema */
@media (prefers-color-scheme: dark){
:root{
--text-light: #f2e6df;
--text-medium: #d8ccc3;
--text-dark: #fff4ec;
--header-color: #E0CFC1;
--background-overlay: rgba(0,0,0,0.8);
--container-bg: rgba(10,10,10,0.5);
--content-bg: #111111;
--border-color-input: #5A5A5A;
--input-bg: #2C2C2C;
--button-bg-initial: #4A4A4A;
--button-bg-hover: #606060;
--highlight-pink: #A860A8;
--progress-color: #7B9D8F;
--highlight-green: #7B9D8F;
--highlight-red: #D32F2F;
--link-color: #A0D2EB;
--link-hover: #C0E8FF;
--achievement-bg: #2C2C2C;
--achievement-text: #E0CFC1;
--modal-bg: rgba(0,0,0,0.9);
--favorite-icon-default: #888;
--favorite-icon-active: #FFC107;
}
}

/* También permitimos toggle manual vía .dark-mode (JS) */
body.dark-mode{
/* reusa las mismas variables que prefers-color-scheme:dark */
--text-light: #f2e6df;
--text-medium: #d8ccc3;
--text-dark: #fff4ec;
--header-color: #E0CFC1;
--background-overlay: rgba(0,0,0,0.8);
--container-bg: rgba(10,10,10,0.5);
--content-bg: #111111;
--border-color-input: #5A5A5A;
--input-bg: #2C2C2C;
--button-bg-initial: #4A4A4A;
--button-bg-hover: #606060;
--highlight-pink: #A860A8;
--progress-color: #7B9D8F;
--highlight-green: #7B9D8F;
--highlight-red: #D32F2F;
--link-color: #A0D2EB;
--link-hover: #C0E8FF;
--achievement-bg: #2C2C2C;
--achievement-text: #E0CFC1;
--modal-bg: rgba(0,0,0,0.9);
--favorite-icon-default: #888;
--favorite-icon-active: #FFC107;
}

/* ==========================
2) RESET / GLOBALS (limpios)
========================== */
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
html{scroll-behavior:smooth}

body{
font-family:var(--primary-font);
background-image:var(--bg-image);
background-repeat:no-repeat;
background-position:center center;
background-size:cover;
background-attachment:var(--background-attachment);
color:var(--text-light);
display:flex;
flex-direction:column;
min-height:100vh;
align-items:center;
justify-content:center;
position:relative;
overflow-x:hidden;
}

/* overlay: evita z-index negativo para compatibilidad */
.background-overlay{
position:fixed;top:0;left:0;width:100%;height:100%;
background-color:var(--background-overlay);
backdrop-filter:blur(8px);
will-change:backdrop-filter;
z-index:0;
}

/* ==========================
3) CONTENEDOR PRINCIPAL
========================== */
.container{
background-color:var(--container-bg);
padding:2.5rem;border-radius:15px;text-align:center;
max-width:900px;width:90%;margin:4rem auto 2rem;position:relative;overflow:hidden;
border:1px solid rgba(255,255,255,0.18);
backdrop-filter:blur(12px) saturate(140%);
-webkit-backdrop-filter:blur(12px) saturate(140%);
transition:transform .4s ease,box-shadow .4s ease;
z-index:1; /* asegura que esté sobre el overlay */
}
.container:hover{transform:translateY(-3px);box-shadow:0 20px 40px rgba(255,120,160,0.18)}

/* ==========================
4) TIPOGRAFÍA / ENCABEZADOS
========================== */
h1{color:var(--header-color);margin-bottom:1.5rem;font-size:3em;text-shadow:2px 2px 5px rgba(0,0,0,0.3);transition:transform .25s ease}
h1:hover{transform:scale(1.01)}
.section-title{color:var(--header-color);margin-top:2.5rem;margin-bottom:1.5rem;font-size:2.2em;text-shadow:1px 1px 3px rgba(0,0,0,0.2)}
.intro-text{font-size:1.2em;margin-bottom:2rem;line-height:1.6;color:var(--text-medium)}

/* ==========================
5) IMÁGENES / MEDIA
========================== */
.header-img{width:150px;height:auto;margin-bottom:1.5rem;animation:float 6s ease-in-out infinite}
@keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-15px)}100%{transform:translateY(0)}}

/* ==========================
6) INPUTS / BOTONES / FORMULARIOS
========================== */
.input-container{display:flex;gap:10px;margin-bottom:2rem;justify-content:center;align-items:center}

#codeInput{
flex-grow:1;max-width:350px;padding:15px 20px;border:2px solid var(--border-color-input);border-radius:8px;
background-color:var(--input-bg);color:var(--text-light);font-size:1.1em;text-align:center;
transition:box-shadow .25s ease, border-color .3s ease, background-color .3s ease, transform .2s ease;
}
#codeInput::placeholder{color:var(--text-medium);opacity:.8}
#codeInput:focus{border-color:var(--highlight-pink);background-color:var(--content-bg)}
#codeInput.success{border-color:var(--highlight-green)}#codeInput.error{border-color:var(--highlight-red)}

/* inputs genéricos */
input[type="text"], textarea, select{
padding:14px 18px;border-radius:8px;border:none;outline:none;font-size:1em;background:var(--input-bg);
color:var(--text-light);backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);
transition:box-shadow .3s ease,transform .2s ease,background .25s ease;
}
input[type="text"]:focus, #codeInput:focus{box-shadow:0 0 14px rgba(255,255,255,.12);background-color:rgba(255,255,255,.06);transform:scale(1.01)}

/* botones */
.button{background-color:var(--button-bg-initial);color:var(--text-light);border:none;border-radius:8px;padding:15px 25px;font-size:1.1em;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:8px;text-decoration:none;transition:transform .18s cubic-bezier(.22,1,.36,1),box-shadow .25s ease,background-color .3s ease}
.button:hover{background-color:var(--button-bg-hover);transform:translateY(-3px) scale(1.02);box-shadow:0 6px 16px rgba(0,0,0,.25)}
.button:active{transform:scale(.97);box-shadow:0 2px 8px rgba(0,0,0,.18)}
.button.small-button{padding:10px 15px;font-size:.95em}

/* focus-visible accesible */
button:focus-visible,a:focus-visible,input:focus-visible,select:focus-visible{outline:3px solid var(--highlight-pink);outline-offset:3px;border-radius:8px}

/* ==========================
7) CONTENIDO / AREA DESBLOQUEADA
========================== */
.contenido-container{background-color:var(--content-bg);padding:2rem;border-radius:10px;box-shadow:inset 0 0 10px rgba(0,0,0,.2);margin-top:2rem;min-height:100px;text-align:left;line-height:1.7;color:var(--text-medium);animation:fadeIn 1s ease-out forwards;word-wrap:break-word;max-width:100%}
.contenido-container h2{color:var(--header-color);margin-bottom:1rem;font-size:1.8em}
.contenido-container p{margin-bottom:1em;white-space:pre-wrap}
.contenido-container img{max-width:100%;height:auto;border-radius:8px;margin:1em 0;display:block;margin-left:auto;margin-right:auto}
.contenido-container iframe{width:100%;max-width:600px;aspect-ratio:16/9;border-radius:8px;margin:1em auto;display:block}
.contenido-container a{color:var(--link-color);text-decoration:none;font-weight:bold;transition:color .3s ease}
.contenido-container a:hover{color:var(--link-hover);text-decoration:underline}

@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeInFromScale{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}

/* ==========================
8) LISTAS / CODIGOS / FAVORITOS
========================== */
.filter-controls{display:flex;flex-wrap:wrap;gap:15px;margin-bottom:1.5rem;justify-content:center}
.filter-controls input[type="text"],.filter-controls select,.filter-controls .button.small-button{padding:10px 15px;border:1px solid var(--border-color-input);border-radius:8px;background-color:var(--input-bg);color:var(--text-light);font-size:1em;width:calc(50% - 10px);max-width:250px;transition:border-color .3s ease}
.filter-controls input[type="text"]:focus,.filter-controls select:focus,.filter-controls .button.small-button:focus{border-color:var(--highlight-pink)}

#filterFavoritesBtn[aria-pressed="true"]{background-color:var(--highlight-pink);color:white}
#filterFavoritesBtn[aria-pressed="true"] .fa-heart{color:var(--favorite-icon-active)}

.lista-codigos{list-style:none;padding:0;margin:0;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:15px}
.lista-codigos li{background-color:var(--input-bg);color:var(--text-dark);padding:10px 15px;border-radius:8px;text-align:left;display:flex;justify-content:space-between;align-items:center;font-size:.95em;transition:background-color .2s ease,transform .2s ease;box-shadow:0 2px 5px rgba(0,0,0,.1);position:relative}
.lista-codigos li:hover{transform:translateY(-3px);box-shadow:0 6px 18px rgba(0,0,0,.25)}
.lista-codigos li span.category{font-size:.8em;color:var(--text-medium);background-color:rgba(255,255,255,.08);padding:3px 8px;border-radius:5px;margin-left:10px}

.favorite-toggle-btn{background:none;border:none;color:var(--favorite-icon-default);font-size:1.2em;cursor:pointer;transition:color .2s ease,transform .2s ease;padding:5px}
.favorite-toggle-btn:hover{transform:scale(1.2)}
.favorite-toggle-btn .far{color:var(--favorite-icon-default)}
.favorite-toggle-btn.active .fas{color:var(--favorite-icon-active)}

/* Especificidad para icons SVG/FontAwesome */
.favorite-toggle-btn i.fas,.favorite-toggle-btn.active i.fas,.favorite-toggle-btn.favorited i.fas,.favorite-toggle-btn[aria-pressed="true"] i.fas,.favorite-toggle-btn.active svg,.favorite-toggle-btn.favorited svg,.favorite-toggle-btn[aria-pressed="true"] svg{color:var(--favorite-icon-active) !important;-webkit-text-fill-color:var(--favorite-icon-active) !important;fill:var(--favorite-icon-active) !important;filter:drop-shadow(0 0 6px rgba(255,215,0,.25)) !important;transform:scale(1.15)}
.favorite-toggle-btn i.far,.favorite-toggle-btn .far{color:var(--favorite-icon-default) !important;fill:none !important}
.favorite-toggle-btn i,.favorite-toggle-btn svg{transition:color 180ms ease,transform 180ms ease,filter 220ms ease}

/* ==========================
9) MÚSICA / AUDIO PANEL / CONTROLES
========================== */
.music-toggle{position:fixed;bottom:15px;right:15px;width:50px;height:50px;font-size:1.3em;background:var(--highlight-pink);padding:14px;border-radius:50%;cursor:pointer;transition:transform .2s ease,box-shadow .25s ease}
.music-toggle:hover{transform:scale(1.12) translateY(-3px);box-shadow:0 10px 25px rgba(0,0,0,.25)}
.music-toggle i{transition:transform .3s ease}
.music-toggle.playing i{animation:pulse 0.7s infinite cubic-bezier(.25,.46,.45,.94)}

@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}

.audio-panel{position:fixed;top:0;right:-350px;width:300px;height:100%;background:var(--container-bg);backdrop-filter:blur(14px) saturate(160%);-webkit-backdrop-filter:blur(14px) saturate(160%);box-shadow:-4px 0 18px rgba(0,0,0,.5);padding:20px;z-index:2000;transition:right .4s cubic-bezier(.25,.8,.25,1),opacity .3s ease;opacity:0}
.audio-panel.show{right:0;opacity:1}
.audio-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px}
.audio-header h3{color:var(--header-color);font-size:1.5em}
.close-audio-btn{background:none;border:none;font-size:1.3em;color:var(--text-light);cursor:pointer;transition:transform .2s ease}
.close-audio-btn:hover{transform:rotate(90deg) scale(1.1)}
.audio-info{text-align:center;margin-bottom:20px}#currentTrackName{font-size:1.2em;color:var(--text-medium)}
.audio-controls{display:flex;justify-content:center;gap:18px;margin-bottom:25px}
.audio-btn{background:var(--button-bg-initial);border:none;color:var(--text-light);padding:12px 14px;border-radius:8px;font-size:1.1em;cursor:pointer;transition:transform .2s ease,background .3s ease}
.audio-btn:hover{background:var(--highlight-pink);transform:scale(1.1)}
.audio-btn.small{padding:10px;font-size:.9em}
.volume-section{text-align:center;margin-bottom:25px;color:var(--text-medium)}
#audioVolume{width:100%;cursor:pointer}
.audio-options{display:flex;justify-content:center;gap:18px}

/* ==========================
10) MODALES / TOASTS / ACCESIBILIDAD
========================== */
.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:var(--modal-bg);backdrop-filter:blur(8px);display:flex;justify-content:center;align-items:center;transition:opacity .3s ease,transform .3s ease}
.modal-content{margin:auto;display:block;max-width:80%;max-height:80vh;border-radius:15px;box-shadow:0 5px 20px rgba(0,0,0,.5);transition:transform .3s ease-out;animation:popIn .35s ease forwards}
.modal-content.fade-in-modal{animation:fadeInFromScale .5s ease-out forwards}
.modal-caption{margin-top:15px;color:var(--text-light);font-size:1.2em;text-align:center;max-width:80%;word-wrap:break-word}
.close{position:absolute;top:20px;right:35px;color:var(--text-light);font-size:40px;font-weight:bold;transition:.3s;cursor:pointer;z-index:1001}
.close:hover,.close:focus{color:var(--highlight-red)}
@keyframes popIn{from{transform:scale(.8);opacity:0}to{transform:scale(1);opacity:1}}

#achievement-toast-container{position:fixed;top:20px;left:50%;transform:translateX(-50%);z-index:1000;display:flex;flex-direction:column;align-items:center;pointer-events:none}
.achievement-toast{background-color:var(--achievement-bg);color:var(--achievement-text);padding:12px 20px;border-radius:8px;margin-bottom:10px;font-size:1.1em;font-weight:bold;opacity:0;transform:translateY(-20px);animation:slideInFadeOut 4s forwards;box-shadow:0 4px 15px rgba(0,0,0,.3);text-align:center;min-width:250px;max-width:80%}
@keyframes slideInFadeOut{0%{opacity:0;transform:translateY(-20px)}10%{opacity:1;transform:translateY(0)}90%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-20px)}}

/* ==========================
11) MENÚ / DROPDOWN
========================== */
.menu-container{position:fixed;top:20px;left:20px;z-index:1001}
.menu-button{background-color:var(--highlight-pink);color:white;border:none;border-radius:50%;width:50px;height:50px;font-size:1.5em;cursor:pointer;box-shadow:0 2px 10px rgba(0,0,0,.3);transition:background-color .3s ease,transform .2s ease}
.menu-button:hover{background-color:var(--button-bg-hover);transform:rotate(5deg)}
.dropdown-menu{position:absolute;top:calc(100% + 10px);left:0;background-color:var(--container-bg);border-radius:8px;box-shadow:0 5px 20px rgba(0,0,0,.4);min-width:200px;padding:10px 0;z-index:1000;opacity:0;transform:translateY(-10px);visibility:hidden;transition:opacity .3s ease,transform .3s ease,visibility .3s ease}
.dropdown-menu.show{opacity:1;transform:translateY(0);visibility:visible}
.dropdown-menu a,.dropdown-menu button{color:var(--text-light);padding:12px 20px;text-decoration:none;display:flex;align-items:center;gap:12px;text-align:left;background:none;border:none;width:100%;font-family:var(--primary-font);font-size:1.1em;cursor:pointer;transition:background .28s ease,color .25s ease,transform .18s cubic-bezier(.22,1,.36,1)}
.dropdown-menu a:hover,.dropdown-menu button:hover{background:rgba(255,255,255,.15);transform:translateX(6px);color:var(--highlight-pink)}
.dropdown-menu a:focus-visible,.dropdown-menu button:focus-visible{outline:2px solid var(--highlight-pink);outline-offset:4px}

/* ==========================
12) ANIMACIONES MISC
========================== */
@keyframes fadeInFromScale{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}

/* ==========================
13) MEDIA QUERIES / RESPONSIVE
========================== */
@media (max-width:768px){
h1{font-size:2.5em}
.intro-text{font-size:1.1em}
.container{padding:1.5rem;margin-top:3rem}
.filter-controls{flex-direction:column}
.filter-controls input[type="text"],.filter-controls select,.filter-controls .button.small-button{width:100%;max-width:none}
.lista-codigos{grid-template-columns:1fr}
.menu-button{width:45px;height:45px;font-size:1.3em}
.dropdown-menu{min-width:180px}
}

@media (max-width:600px){
h1{font-size:2em}
.intro-text{font-size:1em}
.input-container{flex-direction:column}
#codeInput{max-width:100%;width:100%}
.button{width:100%;padding:12px 20px}
.section-title{font-size:1.8em}
.progreso-text{font-size:1em}
.modal-content{max-width:95%}
.close{font-size:30px;top:10px;right:20px}
}

/* breakpoint adicional para pantallas muy pequeñas */
@media (max-width:380px){
.container{padding:1rem;margin-top:2rem}
.header-img{width:120px}
}

/* ==========================
14) ACCESIBILIDAD RECOMENDADA

* No forzamos outline:none globalmente.
* Mantener caret-color visible.
  ========================== */
  button,a,input,select,textarea{caret-color:var(--text-light);-webkit-appearance:none}

/* Fin del archivo optimized */
